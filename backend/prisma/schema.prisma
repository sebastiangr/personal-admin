generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Admin User Model
model User {
  id        String    @id @default(uuid())
  username  String    @unique
  password  String 
  
  companies Company[]
  people    Person[]
}

// Main Data Models
model Company {
  id            String    @id @default(uuid())
  name          String
  type          CompanyType @default(AGENCY_STUDIO)
  country       String?
  city          String?
  email         String?
  website       String?
  careerWebsite String?
  linkedinUrl   String?
  instagramUrl  String?
  behanceUrl    String?
  notes         String?   @db.Text
  interestLevel Int       @default(1)
  status        Status    @default(TO_CONTACT)
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  user          User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId        String

  people        PersonOnCompany[]
  activityLogs  ActivityLog[]
}

model Person {
  id           String    @id @default(uuid())
  name         String
  email        String?
  linkedinUrl  String?
  notes        String?   @db.Text
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt

  user         User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId       String
  
  companies    PersonOnCompany[]
}

model PersonOnCompany {
  person    Person  @relation(fields: [personId], references: [id], onDelete: Cascade)
  personId  String
  company   Company @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId String
  role      String?

  @@id([personId, companyId])
}

model ActivityLog {
  id                String   @id @default(uuid())
  eventDescription  String
  createdAt         DateTime @default(now())
  company           Company  @relation(fields: [companyId], references: [id], onDelete: Cascade)
  companyId         String
}

// --- ENUMS ---
enum CompanyType {
  AGENCY_STUDIO
  TECH_STARTUP
  SOFTWARE_COMPANY
  INDUSTRY
  ECOMMERCE
  FREELANCE_COLLECTIVE
}

enum Status {
  BACKLOG
  TO_CONTACT
  WAITING
  IN_PROGRESS
  ARCHIVED
  HIRED
}